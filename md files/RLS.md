| policy_name                                                   | schema   | table_name                     | using_expression                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | with_check_expression                                                                                                                                                                                                                                                                                                                                                                                                            | permissive | roles           |
| ------------------------------------------------------------- | -------- | ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------- | --------------- |
| Allow users full access to their own calendar events          | public   | calendar_events                | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {authenticated} |
| Users can delete their own calendar events                    | public   | calendar_events                | ((auth.uid())::text = (user_id)::text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can insert their own calendar events                    | public   | calendar_events                | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((auth.uid())::text = (user_id)::text)                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {public}        |
| Users can update their own calendar events                    | public   | calendar_events                | ((auth.uid())::text = (user_id)::text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | ((auth.uid())::text = (user_id)::text)                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {public}        |
| Users can view their own calendar events                      | public   | calendar_events                | ((auth.uid())::text = (user_id)::text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow users to manage their connection requests               | public   | connection_requests            | ((sender_id = auth.uid()) OR (receiver_id = auth.uid()))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | (sender_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                         | PERMISSIVE | {authenticated} |
| Allow users to update requests (accept/reject/cancel)         | public   | connection_requests            | ((auth.uid() = sender_id) OR (auth.uid() = receiver_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can delete their connection requests                    | public   | connection_requests            | ((auth.uid() = sender_id) OR (auth.uid() = receiver_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can read their connection requests                      | public   | connection_requests            | ((auth.uid() = sender_id) OR (auth.uid() = receiver_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can send connection requests                            | public   | connection_requests            | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = sender_id)                                                                                                                                                                                                                                                                                                                                                                                                         | PERMISSIVE | {authenticated} |
| Allow users to delete their connections                       | public   | connections                    | ((user_a_id = auth.uid()) OR (user_b_id = auth.uid()))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Allow users to view their connections                         | public   | connections                    | ((user_a_id = auth.uid()) OR (user_b_id = auth.uid()))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| System can insert connections                                 | public   | connections                    | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | true                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can create connections                                  | public   | connections                    | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((auth.uid() = user_a_id) OR (auth.uid() = user_b_id))                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {public}        |
| Users can create connections based on accepted requests       | public   | connections                    | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (((auth.uid() = user_a_id) OR (auth.uid() = user_b_id)) AND (EXISTS ( SELECT 1
   FROM connection_requests cr
  WHERE ((cr.status = 'accepted'::text) AND (((cr.sender_id = connections.user_a_id) AND (cr.receiver_id = connections.user_b_id)) OR ((cr.sender_id = connections.user_b_id) AND (cr.receiver_id = connections.user_a_id))) AND (cr.receiver_id = auth.uid())))))                                                 | PERMISSIVE | {authenticated} |
| Users can delete their connections                            | public   | connections                    | ((auth.uid() = user_a_id) OR (auth.uid() = user_b_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can update their connections                            | public   | connections                    | ((auth.uid() = user_a_id) OR (auth.uid() = user_b_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can view their connections                              | public   | connections                    | ((auth.uid() = user_a_id) OR (auth.uid() = user_b_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can view their own connections                          | public   | connections                    | ((auth.uid() = user_a_id) OR (auth.uid() = user_b_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Department members can send department chat messages          | public   | department_chat_messages       | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((department_id IN ( SELECT department_members.department_id
   FROM department_members
  WHERE (department_members.user_id = auth.uid()))) AND (sender_id = auth.uid()))                                                                                                                                                                                                                                                        | PERMISSIVE | {public}        |
| Department members can view department chat messages          | public   | department_chat_messages       | (department_id IN ( SELECT department_members.department_id
   FROM department_members
  WHERE (department_members.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow permitted users to manage department members            | public   | department_members             | (department_id IN ( SELECT departments.id
   FROM departments
  WHERE (departments.team_id IN ( SELECT team_members.team_id
           FROM team_members
          WHERE (team_members.user_id = auth.uid())))))                                                                                                                                                                                                                                                                                                                                                                                              | (department_id IN ( SELECT departments.id
   FROM departments
  WHERE has_team_permission(departments.team_id, auth.uid(), 'CAN_MANAGE_DEPARTMENTS'::text)))                                                                                                                                                                                                                                                                     | PERMISSIVE | {authenticated} |
| Insert yourself into department if in the team                | public   | department_members             | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((user_id = auth.uid()) AND (EXISTS ( SELECT 1
   FROM (departments
     JOIN team_members ON ((departments.team_id = team_members.team_id)))
  WHERE ((departments.id = department_members.department_id) AND (team_members.user_id = auth.uid())))))                                                                                                                                                                           | PERMISSIVE | {public}        |
| View department members in your team                          | public   | department_members             | (EXISTS ( SELECT 1
   FROM (departments
     JOIN team_members ON ((departments.team_id = team_members.team_id)))
  WHERE ((departments.id = department_members.department_id) AND (team_members.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Department members can create department updates              | public   | department_updates             | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((department_id IN ( SELECT department_members.department_id
   FROM department_members
  WHERE (department_members.user_id = auth.uid()))) AND (author_id = auth.uid()))                                                                                                                                                                                                                                                        | PERMISSIVE | {public}        |
| Department members can view department updates                | public   | department_updates             | (department_id IN ( SELECT department_members.department_id
   FROM department_members
  WHERE (department_members.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow team members to manage departments                      | public   | departments                    | (team_id IN ( SELECT team_members.team_id
   FROM team_members
  WHERE (team_members.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | has_team_permission(team_id, auth.uid(), 'CAN_MANAGE_DEPARTMENTS'::text)                                                                                                                                                                                                                                                                                                                                                         | PERMISSIVE | {authenticated} |
| Insert department if in the team                              | public   | departments                    | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM team_members
  WHERE ((team_members.team_id = departments.team_id) AND (team_members.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                         | PERMISSIVE | {public}        |
| View departments in teams you're a member of                  | public   | departments                    | (EXISTS ( SELECT 1
   FROM team_members
  WHERE ((team_members.team_id = departments.team_id) AND (team_members.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Service role can manage email queue                           | public   | email_notifications_queue      | ((auth.jwt() ->> 'role'::text) = 'service_role'::text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow users full access to their own focus sessions           | public   | focus_sessions                 | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {authenticated} |
| Allow users to delete their own focus sessions                | public   | focus_sessions                 | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow users to insert their own focus sessions                | public   | focus_sessions                 | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {public}        |
| Allow users to select their own focus sessions                | public   | focus_sessions                 | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow users to update their own focus sessions                | public   | focus_sessions                 | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {public}        |
| Users can insert their own focus sessions                     | public   | focus_sessions                 | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {authenticated} |
| Users can update their own focus sessions                     | public   | focus_sessions                 | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can view their own focus sessions                       | public   | focus_sessions                 | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Allow users to manage their own messages                      | public   | messages                       | ((sender_id = auth.uid()) OR (receiver_id = auth.uid()))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | (sender_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                         | PERMISSIVE | {authenticated} |
| Users can delete their sent messages                          | public   | messages                       | (auth.uid() = sender_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can read their messages                                 | public   | messages                       | ((auth.uid() = sender_id) OR (auth.uid() = receiver_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can send messages                                       | public   | messages                       | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = sender_id)                                                                                                                                                                                                                                                                                                                                                                                                         | PERMISSIVE | {public}        |
| Users can update their received messages                      | public   | messages                       | (auth.uid() = receiver_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow users full access to their own notes                    | public   | notes                          | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | (user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {authenticated} |
| Users can delete their own notes                              | public   | notes                          | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can insert their own notes                              | public   | notes                          | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {public}        |
| Users can select their own notes                              | public   | notes                          | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can update their own notes                              | public   | notes                          | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {public}        |
| Users can insert their own notification preferences           | public   | notification_preferences       | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {public}        |
| Users can insert their own preferences                        | public   | notification_preferences       | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {authenticated} |
| Users can update their own notification preferences           | public   | notification_preferences       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can update their own preferences                        | public   | notification_preferences       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can view their own notification preferences             | public   | notification_preferences       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can view their own preferences                          | public   | notification_preferences       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Service role can insert notifications                         | public   | notifications                  | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | true                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can delete their own notifications                      | public   | notifications                  | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can update their own notifications                      | public   | notifications                  | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can view their own notifications                        | public   | notifications                  | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Team owners can manage project assignments                    | public   | project_department_assignments | (EXISTS ( SELECT 1
   FROM (departments d
     JOIN teams t ON ((d.team_id = t.id)))
  WHERE ((d.id = project_department_assignments.department_id) AND (t.owner_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can view project assignments for their teams            | public   | project_department_assignments | (EXISTS ( SELECT 1
   FROM (departments d
     JOIN team_members tm ON ((d.team_id = tm.team_id)))
  WHERE ((d.id = project_department_assignments.department_id) AND (tm.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow project owners to add members                           | public   | project_members                | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | true                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow project owners to remove members                        | public   | project_members                | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow project owners to update members                        | public   | project_members                | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Authenticated users can view project memberships              | public   | project_members                | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can view project memberships                            | public   | project_members                | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| project_resources_delete                                      | public   | project_resources              | ((uploaded_by_user_id = auth.uid()) OR (EXISTS ( SELECT 1
   FROM projects
  WHERE ((projects.id = project_resources.project_id) AND (projects.owner_id = auth.uid())))))                                                                                                                                                                                                                                                                                                                                                                                                                                     | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| project_resources_insert                                      | public   | project_resources              | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (uploaded_by_user_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                               | PERMISSIVE | {public}        |
| project_resources_select                                      | public   | project_resources              | ((uploaded_by_user_id = auth.uid()) OR (project_id IN ( SELECT project_members.project_id
   FROM project_members
  WHERE (project_members.user_id = auth.uid()))) OR (EXISTS ( SELECT 1
   FROM projects
  WHERE ((projects.id = project_resources.project_id) AND (projects.owner_id = auth.uid())))))                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| project_resources_update                                      | public   | project_resources              | ((uploaded_by_user_id = auth.uid()) OR (EXISTS ( SELECT 1
   FROM projects
  WHERE ((projects.id = project_resources.project_id) AND (projects.owner_id = auth.uid())))))                                                                                                                                                                                                                                                                                                                                                                                                                                     | ((uploaded_by_user_id = auth.uid()) OR (EXISTS ( SELECT 1
   FROM projects
  WHERE ((projects.id = project_resources.project_id) AND (projects.owner_id = auth.uid())))))                                                                                                                                                                                                                                                        | PERMISSIVE | {public}        |
| Allow project members to interact with updates                | public   | project_updates                | (project_id IN ( SELECT project_members.project_id
   FROM project_members
  WHERE (project_members.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | (author_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                         | PERMISSIVE | {authenticated} |
| Allow project members to manage updates                       | public   | project_updates                | (get_project_user_role(project_id, auth.uid()) IS NOT NULL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Authenticated users can view project updates                  | public   | project_updates                | ((EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = project_updates.project_id) AND (pm.user_id = auth.uid())))) OR (EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = project_updates.project_id) AND (p.owner_id = auth.uid())))))                                                                                                                                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Authors can insert their own project updates                  | public   | project_updates                | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((author_id = auth.uid()) AND ((EXISTS ( SELECT 1
   FROM project_members pm
  WHERE ((pm.project_id = project_updates.project_id) AND (pm.user_id = auth.uid())))) OR (EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = project_updates.project_id) AND (p.owner_id = auth.uid()))))))                                                                                                                                     | PERMISSIVE | {authenticated} |
| Authors can update their own project updates                  | public   | project_updates                | (author_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | (author_id = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                         | PERMISSIVE | {authenticated} |
| Project owners or authors can delete updates                  | public   | project_updates                | ((author_id = auth.uid()) OR (EXISTS ( SELECT 1
   FROM projects p
  WHERE ((p.id = project_updates.project_id) AND (p.owner_id = auth.uid())))))                                                                                                                                                                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can view project updates if in the team                 | public   | project_updates                | (EXISTS ( SELECT 1
   FROM (projects
     JOIN team_members ON ((projects.team_id = team_members.team_id)))
  WHERE ((project_updates.project_id = projects.id) AND (team_members.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow authenticated users to create projects                  | public   | projects                       | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | true                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow authorized users to manage projects                     | public   | projects                       | ((owner_id = auth.uid()) OR (id IN ( SELECT project_members.project_id
   FROM project_members
  WHERE ((project_members.user_id = auth.uid()) AND ((project_members.role)::text = ANY ((ARRAY['owner'::character varying, 'admin'::character varying])::text[]))))) OR (team_id IN ( SELECT tm.team_id
   FROM team_members tm
  WHERE ((tm.user_id = auth.uid()) AND (tm.role = ANY (ARRAY['Owner'::text, 'Admin'::text]))))))                                                                                                                                                                              | ((owner_id = auth.uid()) OR (id IN ( SELECT project_members.project_id
   FROM project_members
  WHERE ((project_members.user_id = auth.uid()) AND ((project_members.role)::text = ANY ((ARRAY['owner'::character varying, 'admin'::character varying])::text[]))))) OR (team_id IN ( SELECT tm.team_id
   FROM team_members tm
  WHERE ((tm.user_id = auth.uid()) AND (tm.role = ANY (ARRAY['Owner'::text, 'Admin'::text])))))) | PERMISSIVE | {public}        |
| Allow owners to delete their projects                         | public   | projects                       | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow owners to update their projects                         | public   | projects                       | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow users to view accessible projects                       | public   | projects                       | ((owner_id = auth.uid()) OR (id IN ( SELECT project_members.project_id
   FROM project_members
  WHERE (project_members.user_id = auth.uid()))) OR (team_id IN ( SELECT team_members.team_id
   FROM team_members
  WHERE (team_members.user_id = auth.uid()))) OR (department_id IN ( SELECT department_members.department_id
   FROM department_members
  WHERE (department_members.user_id = auth.uid()))) OR (id IN ( SELECT pda.project_id
   FROM (project_department_assignments pda
     JOIN department_members dm ON ((pda.department_id = dm.department_id)))
  WHERE (dm.user_id = auth.uid())))) | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can manage their own subscriptions                      | public   | push_subscriptions             | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {authenticated} |
| Users can view their own subscriptions                        | public   | push_subscriptions             | (auth.uid() = user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Allow users to insert their own shares                        | public   | resource_shares                | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = shared_by_user_id)                                                                                                                                                                                                                                                                                                                                                                                                 | PERMISSIVE | {authenticated} |
| Allow users to see shares they sent or received               | public   | resource_shares                | ((auth.uid() = shared_by_user_id) OR (auth.uid() = shared_with_user_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can create their own shares                             | public   | resource_shares                | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = shared_by_user_id)                                                                                                                                                                                                                                                                                                                                                                                                 | PERMISSIVE | {public}        |
| Users can delete shares they created                          | public   | resource_shares                | (auth.uid() = shared_by_user_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can manage shares they created or received              | public   | resource_shares                | ((shared_by_user_id = auth.uid()) OR (shared_with_user_id = auth.uid()))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can view shares they are involved in                    | public   | resource_shares                | ((auth.uid() = shared_by_user_id) OR (auth.uid() = shared_with_user_id))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| resources_delete                                              | public   | resources                      | (uploaded_by = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| resources_insert                                              | public   | resources                      | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (uploaded_by = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                       | PERMISSIVE | {public}        |
| resources_select                                              | public   | resources                      | ((uploaded_by = auth.uid()) OR (team_id IN ( SELECT team_members.team_id
   FROM team_members
  WHERE (team_members.user_id = auth.uid()))) OR (project_id IN ( SELECT project_members.project_id
   FROM project_members
  WHERE (project_members.user_id = auth.uid()))) OR (id IN ( SELECT resource_shares.resource_id
   FROM resource_shares
  WHERE (resource_shares.shared_with_user_id = auth.uid()))))                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| resources_update                                              | public   | resources                      | (uploaded_by = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | (uploaded_by = auth.uid())                                                                                                                                                                                                                                                                                                                                                                                                       | PERMISSIVE | {public}        |
| Allow access to tags for accessible tasks                     | public   | task_tags                      | (task_id IN ( SELECT tasks.id
   FROM tasks))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Users can delete their own task tags                          | public   | task_tags                      | (EXISTS ( SELECT 1
   FROM tasks
  WHERE ((tasks.id = task_tags.task_id) AND (tasks.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can insert their own task tags                          | public   | task_tags                      | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM tasks
  WHERE ((tasks.id = task_tags.task_id) AND (tasks.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                     | PERMISSIVE | {public}        |
| Users can manage tags for accessible tasks                    | public   | task_tags                      | (EXISTS ( SELECT 1
   FROM tasks
  WHERE ((tasks.id = task_tags.task_id) AND ((tasks.user_id = auth.uid()) OR (tasks.assigned_to = auth.uid())))))                                                                                                                                                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can update their own task tags                          | public   | task_tags                      | (EXISTS ( SELECT 1
   FROM tasks
  WHERE ((tasks.id = task_tags.task_id) AND (tasks.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | (EXISTS ( SELECT 1
   FROM tasks
  WHERE ((tasks.id = task_tags.task_id) AND (tasks.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                     | PERMISSIVE | {public}        |
| Users can view their own task tags                            | public   | task_tags                      | (EXISTS ( SELECT 1
   FROM tasks
  WHERE ((tasks.id = task_tags.task_id) AND (tasks.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| task_tags_via_task_access                                     | public   | task_tags                      | (task_id IN ( SELECT tasks.id
   FROM tasks
  WHERE ((tasks.user_id = auth.uid()) OR (tasks.assigned_to = auth.uid()) OR (tasks.assigner_id = auth.uid()) OR ((tasks.project_id IS NOT NULL) AND (tasks.project_id IN ( SELECT project_members.project_id
           FROM project_members
          WHERE (project_members.user_id = auth.uid())))))))                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| tasks_delete                                                  | public   | tasks                          | ((user_id = auth.uid()) OR (assigner_id = auth.uid()))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| tasks_insert                                                  | public   | tasks                          | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((user_id = auth.uid()) OR (assigner_id = auth.uid()))                                                                                                                                                                                                                                                                                                                                                                           | PERMISSIVE | {public}        |
| tasks_select                                                  | public   | tasks                          | ((user_id = auth.uid()) OR (assigned_to = auth.uid()) OR (assigner_id = auth.uid()) OR (project_id IN ( SELECT project_members.project_id
   FROM project_members
  WHERE (project_members.user_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| tasks_update                                                  | public   | tasks                          | ((user_id = auth.uid()) OR (assigned_to = auth.uid()) OR (assigner_id = auth.uid()))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((user_id = auth.uid()) OR (assigned_to = auth.uid()) OR (assigner_id = auth.uid()))                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Team members can send team chat messages                      | public   | team_chat_messages             | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((team_id IN ( SELECT team_members.team_id
   FROM team_members
  WHERE (team_members.user_id = auth.uid()))) AND (sender_id = auth.uid()))                                                                                                                                                                                                                                                                                      | PERMISSIVE | {public}        |
| Team members can view team chat messages                      | public   | team_chat_messages             | (team_id IN ( SELECT team_members.team_id
   FROM team_members
  WHERE (team_members.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow any authenticated user to read valid invites            | public   | team_invites                   | (expires_at > now())                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow members with invite permissions to create invites       | public   | team_invites                   | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((auth.uid() = created_by) AND (EXISTS ( SELECT 1
   FROM team_members tm
  WHERE ((tm.team_id = team_invites.team_id) AND (tm.user_id = auth.uid()) AND ((tm.role = 'Owner'::text) OR (tm.role = 'Admin'::text) OR ('CAN_ADD_MEMBERS'::text = ANY (tm.permissions)))))))                                                                                                                                                        | PERMISSIVE | {public}        |
| Allow unauthenticated users to read valid invites for joining | public   | team_invites                   | ((expires_at > now()) AND ((uses_left IS NULL) OR (uses_left > 0)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {anon}          |
| Team admins can create invites                                | public   | team_invites                   | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (team_id IN ( SELECT team_members.team_id
   FROM team_members
  WHERE ((team_members.user_id = auth.uid()) AND (team_members.role = ANY (ARRAY['Owner'::text, 'Admin'::text])))))                                                                                                                                                                                                                                               | PERMISSIVE | {public}        |
| Users can view invites for teams they are members of          | public   | team_invites                   | (team_id IN ( SELECT team_members.team_id
   FROM team_members
  WHERE (team_members.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow owners and users to remove memberships                  | public   | team_members                   | ((user_id = auth.uid()) OR (EXISTS ( SELECT 1
   FROM teams t
  WHERE ((t.id = team_members.team_id) AND (t.owner_id = auth.uid())))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow team owners to add new members                          | public   | team_members                   | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM teams t
  WHERE ((t.id = team_members.team_id) AND (t.owner_id = auth.uid()))))                                                                                                                                                                                                                                                                                                                       | PERMISSIVE | {public}        |
| Allow users to update own membership                          | public   | team_members                   | ((user_id = auth.uid()) OR (EXISTS ( SELECT 1
   FROM teams t
  WHERE ((t.id = team_members.team_id) AND (t.owner_id = auth.uid())))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Authenticated users can view team memberships                 | public   | team_members                   | (auth.role() = 'authenticated'::text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Users can view team memberships                               | public   | team_members                   | (auth.role() = 'authenticated'::text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Team members can create team updates                          | public   | team_updates                   | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((team_id IN ( SELECT team_members.team_id
   FROM team_members
  WHERE (team_members.user_id = auth.uid()))) AND (author_id = auth.uid()))                                                                                                                                                                                                                                                                                      | PERMISSIVE | {public}        |
| Team members can view team updates                            | public   | team_updates                   | (team_id IN ( SELECT team_members.team_id
   FROM team_members
  WHERE (team_members.user_id = auth.uid())))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow authenticated users to create their own teams           | public   | teams                          | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((auth.role() = 'authenticated'::text) AND (auth.uid() = owner_id))                                                                                                                                                                                                                                                                                                                                                              | PERMISSIVE | {public}        |
| Allow owners to delete their teams                            | public   | teams                          | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow owners to update their teams                            | public   | teams                          | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow owners to view their teams                              | public   | teams                          | (auth.uid() = owner_id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow unauthenticated users to read team info for invites     | public   | teams                          | (EXISTS ( SELECT 1
   FROM team_invites
  WHERE ((team_invites.team_id = teams.id) AND (team_invites.expires_at > now()) AND ((team_invites.uses_left IS NULL) OR (team_invites.uses_left > 0)))))                                                                                                                                                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {anon}          |
| Users can view all teams                                      | public   | teams                          | (auth.role() = 'authenticated'::text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| anon_can_read_profiles                                        | public   | user_profiles                  | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {anon}          |
| service_role_full_access                                      | public   | user_profiles                  | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | true                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {service_role}  |
| users_can_delete_own_profile                                  | public   | user_profiles                  | (auth.uid() = id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| users_can_insert_own_profile                                  | public   | user_profiles                  | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | (auth.uid() = id)                                                                                                                                                                                                                                                                                                                                                                                                                | PERMISSIVE | {authenticated} |
| users_can_update_own_profile                                  | public   | user_profiles                  | (auth.uid() = id)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | (auth.uid() = id)                                                                                                                                                                                                                                                                                                                                                                                                                | PERMISSIVE | {authenticated} |
| users_can_view_all_profiles                                   | public   | user_profiles                  | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Allow listening for broadcasts for authenticated users only   | realtime | messages                       | (extension = 'broadcast'::text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {authenticated} |
| Allow users to delete their own files 128fyud_0               | storage  | objects                        | ((bucket_id = 'resources'::text) AND ((storage.foldername(name))[1] = 'public'::text) AND ((storage.foldername(name))[2] = (auth.uid())::text))                                                                                                                                                                                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |
| Allow users to upload files to their own folder 128fyud_0     | storage  | objects                        | null                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ((bucket_id = 'resources'::text) AND ((storage.foldername(name))[1] = 'public'::text) AND ((storage.foldername(name))[2] = (auth.uid())::text))                                                                                                                                                                                                                                                                                  | PERMISSIVE | {public}        |
| Allow users to view their own files 128fyud_0                 | storage  | objects                        | ((bucket_id = 'resources'::text) AND ((storage.foldername(name))[1] = 'public'::text) AND ((storage.foldername(name))[2] = (auth.uid())::text))                                                                                                                                                                                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                                                                                                                                                                                             | PERMISSIVE | {public}        |